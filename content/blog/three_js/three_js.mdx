---
title: Messing Around with three.js
date: 2020-04-23
excerpt: Making some 3D stuff.
topic: programming
---

import SpinningBox from "./spinning_box"
import SineWave from "./sine_wave"
import Pipes from "./pipes"

Making some 3D stuff.

### Spinning Box

A classic: the spinning box.

<SpinningBox />

<ExpandableCodeBlock filePath="three_js/spinning_box.jsx" />

### Sine Wave

Rectangles moving in a sine wave.

<SineWave />

<ExpandableCodeBlock filePath="three_js/sine_wave.jsx" />

### Pipes Screensaver

I came across a GIF of the old "pipes" screensaver from Windows '95 and thought it would be fun to make.
It ended up being a fun challenge, and involved implementing some tricky vector math. I haven't yet gotten around
to the hardest part though, which is making sure the pipes don't intersect themselves.

<Pipes />

One thing that I tried doing to reduce memory usage was pooling materials. Since every pipe segment will use the same material
(only color changes between pipes), we can create a pool of these materials and reuse them across pipe segments, instead of
instantiating a new material for every object in the scene.

```js
const colors = [
  0x3182bd, // blue
  0x229954, // green
  0xF08080, // coral
];
let materials = [];
for (const color of colors) {
  materials.push(new THREE.MeshStandardMaterial({color: color}));
}

const createCylinder = function() {
  let geometry = new THREE.CylinderGeometry(R, R, 0, RADIAL_SEGMENTS);
  let material = materials[numPipes];
  let mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);
  return mesh;
}
```

<ExpandableCodeBlock filePath="three_js/pipes.jsx" />
