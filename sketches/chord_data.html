<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>cselig</title><link rel="icon" href="favicon.ico"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/62ae7adc418c4fa89ac0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/62ae7adc418c4fa89ac0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b3c25108c77d22e4bb58.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b3c25108c77d22e4bb58.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-70acde2203962b3dc5d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50d38cb9c3dd5374e2a2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.0a4392dc64510ab178c1.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.6d3bde474c27debf47e2.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-1018bc17b6123053b3bf.js" as="script"/><link rel="preload" href="/_next/static/chunks/fe66c3e56503ac18952228a608ca3464c3766972.02ceb7646fd5a00b4908.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/sketches/%5Bid%5D-efff1a0c2435fd0b2b31.js" as="script"/></head><body><div id="__next"><div class="layout_container__3H2Qg"><svg class="MuiSvgIcon-root layout_back_button__-f7Kp" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg><h1 class="sketch_title__2-Xm5">Data-driven Chord Progressions</h1><div><p>Whenever I listen to music I like trying to identify chord progressions and find common (or uncommon) patterns and changes.
I recently came across the <a href="https://ddmal.music.mcgill.ca/research/The_McGill_Billboard_Project_(Chord_Analysis_Dataset)/">McGill Billboard dataset</a>,
which is a set of Billboard Top 40 songs from the 60s, 70s, and 80s annotated with structure and chord information. This led me to build
a little widget for creating 4-chord progressions.</p>
<h2>Chord Bigrams</h2>
<p>The chord picker is based on chord bigrams, which are just pairs of chords that appear one after the other in a song. For example, if I have this 4-chord
progression:</p>
<p><strong>1maj</strong> -> <strong>5maj</strong> -> <strong>6min</strong> -> <strong>4maj</strong></p>
<p>Then I can extract the following three chord bigrams:</p>
<ul>
<li><strong>1maj</strong> -> <strong>5maj</strong></li>
<li><strong>5maj</strong> -> <strong>6min</strong></li>
<li><strong>6min</strong> -> <strong>4maj</strong></li>
</ul>
<p>If this progression repeated there would also be the <strong>4maj</strong> -> <strong>1maj</strong> bigram.</p>
<h2>Counting Bigrams</h2>
<p>In the widget, chords are sorted by the frequency of the chord bigram with that chord and the previous one. So if I chose <strong>1maj</strong> as my
first chord, the list of possibilities for chord 2 would be sorted based on how often a chord is observed to come after <strong>1maj</strong> in the dataset.
(This is true for all but the first chord, where a small set of "seed" chords are listed.)</p>
<p>This means if you're picking chords at the top of the list, your progression will sound more normal/conventional/diatonic. If you're picking chords
near the bottom of the list your progression could sound more distinctive, but it could also sound more disjointed or nonsensical.</p>
<p>If you don't have an ear for chord progressions I suggest first plugging the progression above (which appears in <a href="https://www.youtube.com/watch?v=HTYrkOZ5nCs">quite a few songs</a>)
into the widget below, hearing how it sounds, and then trying to modify it.</p>
</div><div></div><h2>Code:</h2><div><pre style="-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;white-space:pre-wrap;word-wrap:normal;font-family:Menlo, Monaco, &quot;Courier New&quot;, monospace;font-size:14px;color:#76d9e6;text-shadow:none;background:#2a2a2a;padding:15px;border-radius:4px;border:1px solid #e1e1e8;overflow:auto;position:relative"><code class="language-javascript" style="-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;white-space:pre;word-wrap:normal;font-family:Menlo, Monaco, &quot;Courier New&quot;, monospace;font-size:14px;color:#76d9e6;text-shadow:none"><span class="token module" style="color:#ef3b7d">import</span><span> </span><span class="token imports maybe-class-name">MIDISounds</span><span> </span><span class="token module" style="color:#ef3b7d">from</span><span> </span><span class="token" style="color:#e6d06c">&#x27;midi-sounds-react&#x27;</span><span class="token" style="color:#bebec5">;</span><span>
</span><span></span><span class="token module" style="color:#ef3b7d">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#bebec5">,</span><span class="token imports"> </span><span class="token imports" style="color:#bebec5">{</span><span class="token imports"> useState </span><span class="token imports" style="color:#bebec5">}</span><span> </span><span class="token module" style="color:#ef3b7d">from</span><span> </span><span class="token" style="color:#e6d06c">&#x27;react&#x27;</span><span>
</span><span></span><span class="token module" style="color:#ef3b7d">import</span><span> </span><span class="token imports" style="color:#bebec5">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">CSSTransition</span><span class="token imports"> </span><span class="token imports" style="color:#bebec5">}</span><span> </span><span class="token module" style="color:#ef3b7d">from</span><span> </span><span class="token" style="color:#e6d06c">&quot;react-transition-group&quot;</span><span>
</span><span></span><span class="token module" style="color:#ef3b7d">import</span><span> </span><span class="token imports" style="color:#bebec5">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Clear</span><span class="token imports" style="color:#bebec5">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">PlayArrow</span><span class="token imports" style="color:#bebec5">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Stop</span><span class="token imports"> </span><span class="token imports" style="color:#bebec5">}</span><span> </span><span class="token module" style="color:#ef3b7d">from</span><span> </span><span class="token" style="color:#e6d06c">&#x27;@material-ui/icons&#x27;</span><span class="token" style="color:#bebec5">;</span><span>
</span>
<span></span><span class="token module" style="color:#ef3b7d">import</span><span> </span><span class="token imports">data</span><span> </span><span class="token module" style="color:#ef3b7d">from</span><span> </span><span class="token" style="color:#e6d06c">&#x27;../../data/chords/chord_to_successors.json&#x27;</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token constant">TONIC</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">50</span><span>
</span><span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token constant">TEMPO</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">120</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token constant">CHORD_SHAPES</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;maj&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">4</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">7</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;maj7&quot;</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">4</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">7</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">10</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;min&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">7</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;sus&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">5</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">7</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;dim&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">6</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">9</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;aug&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">4</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">8</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span><span></span><span class="token" style="color:#ef3b7d">let</span><span> </span><span class="token constant">CHORDS</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">}</span><span>
</span><span></span><span class="token control-flow" style="color:#ef3b7d">for</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token" style="color:#bebec5">[</span><span>name</span><span class="token" style="color:#bebec5">,</span><span> notes</span><span class="token" style="color:#bebec5">]</span><span> </span><span class="token" style="color:#ef3b7d">of</span><span> </span><span class="token known-class-name class-name">Object</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">entries</span><span class="token" style="color:#bebec5">(</span><span class="token constant">CHORD_SHAPES</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token constant">CHORDS</span><span class="token" style="color:#bebec5">[</span><span>name</span><span class="token" style="color:#bebec5">]</span><span> </span><span class="token" style="color:#a77afe">=</span><span> notes</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">note</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> note </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token constant">TONIC</span><span class="token" style="color:#bebec5">)</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span><span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token constant">OFFSETS</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;b7&quot;</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">-</span><span class="token" style="color:#a77afe">2</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;7&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">-</span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;1&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;b2&quot;</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;2&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">2</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;b3&quot;</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;3&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">4</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;4&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">5</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;5&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">7</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;b6&quot;</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">8</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>  </span><span class="token" style="color:#e6d06c">&quot;6&quot;</span><span class="token" style="color:#a77afe">:</span><span>  </span><span class="token" style="color:#a77afe">9</span><span class="token" style="color:#bebec5">,</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token constant">TRANSITION_TIME</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">300</span><span> </span><span class="token" style="color:#6f705e">// ms</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function maybe-class-name">ChordList</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter" style="color:#bebec5">{</span><span class="token parameter">chords</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> onSelect</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> inProp</span><span class="token parameter" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token" style="color:#bebec5">[</span><span>height</span><span class="token" style="color:#bebec5">,</span><span> setHeight</span><span class="token" style="color:#bebec5">]</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token function">useState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>  </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">CSSTransition</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">in</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>inProp</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      appear</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      timeout</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#a77afe">1000</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      onEntering</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token function">setHeight</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#a77afe">40</span><span> </span><span class="token" style="color:#a77afe">*</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      onExit</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token function">setHeight</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span>div className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;chords&quot;</span><span> style</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">{</span><span>height</span><span class="token" style="color:#a77afe">:</span><span> height</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#6f705e">/* chords *should* be unique */</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">{</span><span>chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">chord</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> i</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>          </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token" style="color:#bebec5">[</span><span>startOpacity</span><span class="token" style="color:#bebec5">,</span><span> endOpacity</span><span class="token" style="color:#bebec5">]</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">0.3</span><span class="token" style="color:#bebec5">]</span><span>
</span><span>          </span><span class="token" style="color:#ef3b7d">let</span><span> opacity
</span><span>          </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span>chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">2</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>            </span><span class="token" style="color:#6f705e">// hack - don&#x27;t want a gradient for picking the first chord</span><span>
</span><span>            opacity </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">1</span><span>
</span><span>          </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>            opacity </span><span class="token" style="color:#a77afe">=</span><span> startOpacity </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>i </span><span class="token" style="color:#a77afe">/</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#a77afe">*</span><span> </span><span class="token" style="color:#bebec5">(</span><span>endOpacity </span><span class="token" style="color:#a77afe">-</span><span> startOpacity</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>          </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>          </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>            </span><span class="token" style="color:#a77afe">&lt;</span><span>p
</span><span>              className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;chord&quot;</span><span>
</span><span>              chord</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>chord</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>              onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onSelect</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>              style</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">{</span><span>opacity</span><span class="token" style="color:#a77afe">:</span><span> opacity</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>              key</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>chord</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            </span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span>chord</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>p</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">&lt;</span><span>style jsx</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .chords {
</span><span class="token template-string" style="color:#e6d06c">            display: flex;
</span><span class="token template-string" style="color:#e6d06c">            flex-direction: column;
</span><span class="token template-string" style="color:#e6d06c">            align-items: center;
</span><span class="token template-string" style="color:#e6d06c">            transition: height </span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">${</span><span class="token template-string interpolation constant">TRANSITION_TIME</span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">}</span><span class="token template-string" style="color:#e6d06c">ms;
</span><span class="token template-string" style="color:#e6d06c">            overflow: hidden;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .chord {
</span><span class="token template-string" style="color:#e6d06c">            cursor: pointer;
</span><span class="token template-string" style="color:#e6d06c">            margin: 0.5em;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">        </span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>style</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span class="token maybe-class-name">CSSTransition</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">)</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function maybe-class-name">NextChordPicker</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter" style="color:#bebec5">{</span><span class="token parameter">data</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> onSelect</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> inProp</span><span class="token parameter" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token" style="color:#ef3b7d">let</span><span> chords </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#bebec5">]</span><span>
</span><span>  </span><span class="token control-flow" style="color:#ef3b7d">for</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">const</span><span> chord </span><span class="token" style="color:#ef3b7d">in</span><span> data</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>    chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">push</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">[</span><span>chord</span><span class="token" style="color:#bebec5">,</span><span> data</span><span class="token" style="color:#bebec5">[</span><span>chord</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>  chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">sort</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">a</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> b</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> b</span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">]</span><span> </span><span class="token" style="color:#a77afe">-</span><span> a</span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>  chords </span><span class="token" style="color:#a77afe">=</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">x</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> x</span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>  </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span>div className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;next-chord-picker&quot;</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">ChordList</span><span> chords</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>chords</span><span class="token" style="color:#bebec5">}</span><span> onSelect</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onSelect</span><span class="token" style="color:#bebec5">}</span><span> inProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>inProp</span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">)</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function maybe-class-name">FirstChordPicker</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter" style="color:#bebec5">{</span><span class="token parameter">onSelect</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> inProp</span><span class="token parameter" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>  </span><span class="token" style="color:#a77afe">&lt;</span><span>div className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;first-chord-picker&quot;</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">ChordList</span><span> chords</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#e6d06c">&quot;1maj&quot;</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#e6d06c">&quot;1min&quot;</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#e6d06c">&quot;2min&quot;</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#e6d06c">&quot;4maj&quot;</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#e6d06c">&quot;5maj&quot;</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">}</span><span> onSelect</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onSelect</span><span class="token" style="color:#bebec5">}</span><span> inProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>inProp</span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span></span><span class="token" style="color:#bebec5">)</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function maybe-class-name">ProgressionDisplay</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter" style="color:#bebec5">{</span><span class="token parameter">chords</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> active</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> onSelect</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> listInProp</span><span class="token parameter" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  chords </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token spread" style="color:#a77afe">...</span><span>chords</span><span class="token" style="color:#bebec5">]</span><span>
</span><span>  </span><span class="token" style="color:#ef3b7d">const</span><span> active_index </span><span class="token" style="color:#a77afe">=</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span>
</span><span>  </span><span class="token" style="color:#ef3b7d">const</span><span> pad </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">4</span><span> </span><span class="token" style="color:#a77afe">-</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span>
</span><span>  </span><span class="token control-flow" style="color:#ef3b7d">for</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">let</span><span> i </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">;</span><span> i </span><span class="token" style="color:#a77afe">&lt;</span><span> pad</span><span class="token" style="color:#bebec5">;</span><span> i</span><span class="token" style="color:#a77afe">++</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span> chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">push</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#e6d06c">&quot;?&quot;</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span>div className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;progression-display&quot;</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">{</span><span>chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">chord</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> i</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&lt;</span><span>div key</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>i</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#a77afe">&lt;</span><span>p className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#e6d06c">&quot;progression-chord &quot;</span><span> </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>chord </span><span class="token" style="color:#a77afe">!==</span><span> </span><span class="token" style="color:#e6d06c">&quot;?&quot;</span><span> </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#e6d06c">&quot;selected&quot;</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#e6d06c">&quot;&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span>chord</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>p</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#bebec5">{</span><span>active_index </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">0</span><span> </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span> i </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">0</span><span> </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span> active </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span>
</span><span>              </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">FirstChordPicker</span><span> onSelect</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onSelect</span><span class="token" style="color:#bebec5">}</span><span> inProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>listInProp</span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            </span><span class="token" style="color:#bebec5">{</span><span>active_index </span><span class="token" style="color:#a77afe">===</span><span> i </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span> i </span><span class="token" style="color:#a77afe">&gt;</span><span> </span><span class="token" style="color:#a77afe">0</span><span> </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span> active </span><span class="token" style="color:#a77afe">&amp;&amp;</span><span>
</span><span>              </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">NextChordPicker</span><span> data</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>data</span><span class="token" style="color:#bebec5">[</span><span>chords</span><span class="token" style="color:#bebec5">[</span><span>i </span><span class="token" style="color:#a77afe">-</span><span> </span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">}</span><span> onSelect</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onSelect</span><span class="token" style="color:#bebec5">}</span><span> inProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>listInProp</span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span>style jsx</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .progression-display {
</span><span class="token template-string" style="color:#e6d06c">          display: flex;
</span><span class="token template-string" style="color:#e6d06c">          opacity: 1;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .progression-chord {
</span><span class="token template-string" style="color:#e6d06c">          margin: 1em;
</span><span class="token template-string" style="color:#e6d06c">          padding: 0.5em;
</span><span class="token template-string" style="color:#e6d06c">          border: 1px solid black;
</span><span class="token template-string" style="color:#e6d06c">          border-radius: 0.5em;
</span><span class="token template-string" style="color:#e6d06c">          width: 3em;
</span><span class="token template-string" style="color:#e6d06c">          text-align: center;
</span><span class="token template-string" style="color:#e6d06c">          transition: opacity </span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">${</span><span class="token template-string interpolation constant">TRANSITION_TIME</span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">}</span><span class="token template-string" style="color:#e6d06c">ms;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .progression-chord:not(.selected) {
</span><span class="token template-string" style="color:#e6d06c">          opacity: 0.3;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">      </span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>style</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">)</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function maybe-class-name">Text</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter" style="color:#bebec5">{</span><span class="token parameter">clickable</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> text</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> onClick</span><span class="token parameter" style="color:#bebec5">,</span><span class="token parameter"> inProp</span><span class="token parameter" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">CSSTransition</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">in</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>inProp</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      appear</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      timeout</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token constant">TRANSITION_TIME</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span>div
</span><span>        className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#e6d06c">&quot;text &quot;</span><span> </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>clickable </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#e6d06c">&quot;clickable&quot;</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#e6d06c">&quot;&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>onClick</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">&lt;</span><span>p</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span>text</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>p</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">&lt;</span><span>style jsx</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .text {
</span><span class="token template-string" style="color:#e6d06c">            font-weight: 400;
</span><span class="token template-string" style="color:#e6d06c">            height: 2em;
</span><span class="token template-string" style="color:#e6d06c">            margin: 0.5em;
</span><span class="token template-string" style="color:#e6d06c">            transition: opacity </span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">${</span><span class="token template-string interpolation constant">TRANSITION_TIME</span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">}</span><span class="token template-string" style="color:#e6d06c">ms;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .clickable {
</span><span class="token template-string" style="color:#e6d06c">            cursor: pointer;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .enter {
</span><span class="token template-string" style="color:#e6d06c">            opacity: 0;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .enter-active, .enter-done {
</span><span class="token template-string" style="color:#e6d06c">            opacity: 1;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          .exit-active, .exit-done {
</span><span class="token template-string" style="color:#e6d06c">            opacity: 0;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">          p {
</span><span class="token template-string" style="color:#e6d06c">            font-size: 1.5em;
</span><span class="token template-string" style="color:#e6d06c">            margin: 0;
</span><span class="token template-string" style="color:#e6d06c">          }
</span><span class="token template-string" style="color:#e6d06c">        </span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>style</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span class="token maybe-class-name">CSSTransition</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">)</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token" style="color:#ef3b7d">class</span><span> </span><span class="token class-name">ChordPicker</span><span> </span><span class="token" style="color:#ef3b7d">extends</span><span> </span><span class="token class-name">React</span><span class="token class-name" style="color:#bebec5">.</span><span class="token class-name">Component</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>  </span><span class="token function">constructor</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">props</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">super</span><span class="token" style="color:#bebec5">(</span><span>props</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      chords</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>      started</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">false</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>      textInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>      listInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">false</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>  </span><span class="token function">render</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function">resetChords</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">stopPlayLoop</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">{</span><span>chords</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span> textInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function">chordToNotes</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter">chord</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">let</span><span> offsetLen
</span><span>      </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span>chord</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">startsWith</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#e6d06c">&quot;b&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>        offsetLen </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">2</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>        offsetLen </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#a77afe">1</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">const</span><span> offset </span><span class="token" style="color:#a77afe">=</span><span> chord</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">substring</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">,</span><span> offsetLen</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">const</span><span> shape </span><span class="token" style="color:#a77afe">=</span><span> chord</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">substring</span><span class="token" style="color:#bebec5">(</span><span>offsetLen</span><span class="token" style="color:#bebec5">,</span><span> chord</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token constant">CHORDS</span><span class="token" style="color:#bebec5">[</span><span>shape</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">x</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> x </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token constant">OFFSETS</span><span class="token" style="color:#bebec5">[</span><span>offset</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function">playChords</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">==</span><span> </span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token control-flow" style="color:#ef3b7d">return</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">const</span><span> beat </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">map</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">chord</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">[</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#6f705e">// drums</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">[</span><span>
</span><span>          </span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token function">chordToNotes</span><span class="token" style="color:#bebec5">(</span><span>chord</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">]</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">]</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">startPlayLoop</span><span class="token" style="color:#bebec5">(</span><span>beat</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token constant">TEMPO</span><span class="token" style="color:#bebec5">,</span><span> </span><span class="token" style="color:#a77afe">1</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">const</span><span> </span><span class="token function-variable function">selectChord</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token parameter">e</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">const</span><span> chord </span><span class="token" style="color:#a77afe">=</span><span> e</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">target</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">getAttribute</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#e6d06c">&quot;chord&quot;</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">{</span><span>listInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">false</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>        </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">{</span><span>textInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">false</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>      </span><span class="token function">setTimeout</span><span class="token" style="color:#bebec5">(</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>          </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span>
</span><span>            </span><span class="token" style="color:#bebec5">(</span><span class="token parameter">oldState</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span> </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">{</span><span>chords</span><span class="token" style="color:#a77afe">:</span><span> oldState</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">concat</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">[</span><span>chord</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">,</span><span> listInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>            </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>              </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">loopStarted</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>                </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">stopPlayLoop</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>                </span><span class="token function">playChords</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>              </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          </span><span class="token" style="color:#bebec5">)</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>        </span><span class="token constant">TRANSITION_TIME</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">)</span><span>
</span>
<span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">const</span><span> clear_enabled </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">&gt;</span><span> </span><span class="token" style="color:#a77afe">0</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">const</span><span> play_enabled </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">4</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">const</span><span> stop_enabled </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">4</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">let</span><span> text
</span><span>    </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#a77afe">!</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">started</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      text </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#e6d06c">&quot;Click to start!&quot;</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">===</span><span> </span><span class="token" style="color:#a77afe">0</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      text </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#e6d06c">&quot;Pick your first chord&quot;</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#a77afe">&lt;</span><span> </span><span class="token" style="color:#a77afe">4</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      text </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#e6d06c">&quot;Pick your next chord&quot;</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      text </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#e6d06c">&quot;&quot;</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>    </span><span class="token" style="color:#ef3b7d">let</span><span> textOnClick
</span><span>    </span><span class="token control-flow" style="color:#ef3b7d">if</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">started</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      textOnClick </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token nil" style="color:#ef3b7d">undefined</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span> </span><span class="token control-flow" style="color:#ef3b7d">else</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>      </span><span class="token function-variable function">textOnClick</span><span> </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">{</span><span>
</span><span>        </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">{</span><span>textInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">false</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span>
</span><span>        </span><span class="token function">setTimeout</span><span class="token" style="color:#bebec5">(</span><span>
</span><span>          </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">setState</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">{</span><span>started</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">,</span><span> textInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">,</span><span> listInProp</span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#a77afe">true</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">,</span><span>
</span><span>          </span><span class="token constant">TRANSITION_TIME</span><span>
</span><span>        </span><span class="token" style="color:#bebec5">)</span><span>
</span><span>      </span><span class="token" style="color:#bebec5">}</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span>    </span><span class="token" style="color:#ef3b7d">const</span><span> iconSize </span><span class="token" style="color:#a77afe">=</span><span> </span><span class="token" style="color:#e6d06c">&quot;30px&quot;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#bebec5">(</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span>div id</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;chord-picker&quot;</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">MIDISounds</span><span>
</span><span>          ref</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">(</span><span class="token parameter">ref</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span> </span><span class="token" style="color:#a77afe">=</span><span> ref</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          appElementName</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;__next&quot;</span><span>
</span><span>          instruments</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#bebec5">[</span><span class="token" style="color:#a77afe">3</span><span class="token" style="color:#bebec5">]</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span>
<span>        </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">Text</span><span>
</span><span>          text</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>text</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>textOnClick</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          clickable</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#a77afe">!</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">started</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          inProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">textInProp</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span>
<span>        </span><span class="token" style="color:#a77afe">&lt;</span><span>div className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;controls&quot;</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&lt;</span><span>span
</span><span>            className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#e6d06c">&quot;button &quot;</span><span> </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>clear_enabled </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#e6d06c">&quot;enabled&quot;</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#e6d06c">&quot;disabled&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>clear_enabled </span><span class="token" style="color:#a77afe">?</span><span> resetChords </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token nil" style="color:#ef3b7d">undefined</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>           </span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">Clear</span><span> fontSize</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;inherit&quot;</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>span</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&lt;</span><span>span
</span><span>            className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#e6d06c">&quot;button material-icons-outlined &quot;</span><span> </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>play_enabled </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#e6d06c">&quot;enabled&quot;</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#e6d06c">&quot;disabled&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>play_enabled </span><span class="token" style="color:#a77afe">?</span><span> playChords </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token nil" style="color:#ef3b7d">undefined</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">PlayArrow</span><span> fontSize</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;inherit&quot;</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>span</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&lt;</span><span>span
</span><span>            className</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#e6d06c">&quot;button material-icons-outlined &quot;</span><span> </span><span class="token" style="color:#a77afe">+</span><span> </span><span class="token" style="color:#bebec5">(</span><span>stop_enabled </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#e6d06c">&quot;enabled&quot;</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token" style="color:#e6d06c">&quot;disabled&quot;</span><span class="token" style="color:#bebec5">)</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>            onClick</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>stop_enabled </span><span class="token" style="color:#a77afe">?</span><span> </span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token arrow" style="color:#a77afe">=&gt;</span><span> </span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">midiSounds</span><span class="token" style="color:#bebec5">.</span><span class="token method function property-access">stopPlayLoop</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#a77afe">:</span><span> </span><span class="token nil" style="color:#ef3b7d">undefined</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          </span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">Stop</span><span> fontSize</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#e6d06c">&quot;inherit&quot;</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>span</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span>
<span>        </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">ProgressionDisplay</span><span>
</span><span>          chords</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">chords</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          active</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">started</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          onSelect</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span>selectChord</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>          listInProp</span><span class="token" style="color:#a77afe">=</span><span class="token" style="color:#bebec5">{</span><span class="token" style="color:#ef3b7d">this</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">state</span><span class="token" style="color:#bebec5">.</span><span class="token property-access">listInProp</span><span class="token" style="color:#bebec5">}</span><span>
</span><span>        </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span>style jsx</span><span class="token" style="color:#a77afe">&gt;</span><span class="token" style="color:#bebec5">{</span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        #chord-picker {
</span><span class="token template-string" style="color:#e6d06c">          display: flex;
</span><span class="token template-string" style="color:#e6d06c">          flex-direction: column;
</span><span class="token template-string" style="color:#e6d06c">          align-items: center;
</span><span class="token template-string" style="color:#e6d06c">          margin-top: 5em;
</span><span class="token template-string" style="color:#e6d06c">          min-height: 750px;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .button {
</span><span class="token template-string" style="color:#e6d06c">          font-size: 30px;
</span><span class="token template-string" style="color:#e6d06c">          margin: 4px;
</span><span class="token template-string" style="color:#e6d06c">          cursor: pointer;
</span><span class="token template-string" style="color:#e6d06c">          transition: opacity </span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">${</span><span class="token template-string interpolation constant">TRANSITION_TIME</span><span class="token template-string interpolation interpolation-punctuation" style="color:#bebec5">}</span><span class="token template-string" style="color:#e6d06c">ms;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .button.enabled {
</span><span class="token template-string" style="color:#e6d06c">          opacity: 1;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        .button.disabled {
</span><span class="token template-string" style="color:#e6d06c">          opacity: 0.3;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">
</span><span class="token template-string" style="color:#e6d06c">        // doesn&#x27;t work
</span><span class="token template-string" style="color:#e6d06c">        .MIDISounds {
</span><span class="token template-string" style="color:#e6d06c">          display: none;
</span><span class="token template-string" style="color:#e6d06c">        }
</span><span class="token template-string" style="color:#e6d06c">      </span><span class="token template-string template-punctuation" style="color:#e6d06c">`</span><span class="token" style="color:#bebec5">}</span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>style</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>      </span><span class="token" style="color:#a77afe">&lt;</span><span class="token" style="color:#a77afe">/</span><span>div</span><span class="token" style="color:#a77afe">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#bebec5">)</span><span>
</span><span>  </span><span class="token" style="color:#bebec5">}</span><span>
</span><span></span><span class="token" style="color:#bebec5">}</span><span>
</span>
<span></span><span class="token module" style="color:#ef3b7d">export</span><span> </span><span class="token module" style="color:#ef3b7d">default</span><span> </span><span class="token" style="color:#ef3b7d">function</span><span> </span><span class="token function maybe-class-name">ChordPickerFn</span><span class="token" style="color:#bebec5">(</span><span class="token" style="color:#bebec5">)</span><span> </span><span class="token" style="color:#bebec5">{</span><span> </span><span class="token control-flow" style="color:#ef3b7d">return</span><span> </span><span class="token" style="color:#a77afe">&lt;</span><span class="token maybe-class-name">ChordPicker</span><span> </span><span class="token" style="color:#a77afe">/</span><span class="token" style="color:#a77afe">&gt;</span><span> </span><span class="token" style="color:#bebec5">}</span><span>
</span>
</code></pre></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"sketchData":{"id":"chord_data","contentHtml":"\u003cp\u003eWhenever I listen to music I like trying to identify chord progressions and find common (or uncommon) patterns and changes.\nI recently came across the \u003ca href=\"https://ddmal.music.mcgill.ca/research/The_McGill_Billboard_Project_(Chord_Analysis_Dataset)/\"\u003eMcGill Billboard dataset\u003c/a\u003e,\nwhich is a set of Billboard Top 40 songs from the 60s, 70s, and 80s annotated with structure and chord information. This led me to build\na little widget for creating 4-chord progressions.\u003c/p\u003e\n\u003ch2\u003eChord Bigrams\u003c/h2\u003e\n\u003cp\u003eThe chord picker is based on chord bigrams, which are just pairs of chords that appear one after the other in a song. For example, if I have this 4-chord\nprogression:\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e1maj\u003c/strong\u003e -\u003e \u003cstrong\u003e5maj\u003c/strong\u003e -\u003e \u003cstrong\u003e6min\u003c/strong\u003e -\u003e \u003cstrong\u003e4maj\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThen I can extract the following three chord bigrams:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e1maj\u003c/strong\u003e -\u003e \u003cstrong\u003e5maj\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e5maj\u003c/strong\u003e -\u003e \u003cstrong\u003e6min\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e6min\u003c/strong\u003e -\u003e \u003cstrong\u003e4maj\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf this progression repeated there would also be the \u003cstrong\u003e4maj\u003c/strong\u003e -\u003e \u003cstrong\u003e1maj\u003c/strong\u003e bigram.\u003c/p\u003e\n\u003ch2\u003eCounting Bigrams\u003c/h2\u003e\n\u003cp\u003eIn the widget, chords are sorted by the frequency of the chord bigram with that chord and the previous one. So if I chose \u003cstrong\u003e1maj\u003c/strong\u003e as my\nfirst chord, the list of possibilities for chord 2 would be sorted based on how often a chord is observed to come after \u003cstrong\u003e1maj\u003c/strong\u003e in the dataset.\n(This is true for all but the first chord, where a small set of \"seed\" chords are listed.)\u003c/p\u003e\n\u003cp\u003eThis means if you're picking chords at the top of the list, your progression will sound more normal/conventional/diatonic. If you're picking chords\nnear the bottom of the list your progression could sound more distinctive, but it could also sound more disjointed or nonsensical.\u003c/p\u003e\n\u003cp\u003eIf you don't have an ear for chord progressions I suggest first plugging the progression above (which appears in \u003ca href=\"https://www.youtube.com/watch?v=HTYrkOZ5nCs\"\u003equite a few songs\u003c/a\u003e)\ninto the widget below, hearing how it sounds, and then trying to modify it.\u003c/p\u003e\n","code":"import MIDISounds from 'midi-sounds-react';\nimport React, { useState } from 'react'\nimport { CSSTransition } from \"react-transition-group\"\nimport { Clear, PlayArrow, Stop } from '@material-ui/icons';\n\nimport data from '../../data/chords/chord_to_successors.json'\n\nconst TONIC = 50\nconst TEMPO = 120\n\nconst CHORD_SHAPES = {\n  \"maj\":  [0, 4, 7],\n  \"maj7\": [0, 4, 7, 10],\n  \"min\":  [0, 3, 7],\n  \"sus\":  [0, 5, 7],\n  \"dim\":  [0, 3, 6, 9],\n  \"aug\":  [0, 4, 8],\n}\nlet CHORDS = {}\nfor (const [name, notes] of Object.entries(CHORD_SHAPES)) {\n  CHORDS[name] = notes.map(note =\u003e note + TONIC)\n}\nconst OFFSETS = {\n  \"b7\": -2,\n  \"7\":  -1,\n  \"1\":  0,\n  \"b2\": 1,\n  \"2\":  2,\n  \"b3\": 3,\n  \"3\":  4,\n  \"4\":  5,\n  \"5\":  7,\n  \"b6\": 8,\n  \"6\":  9,\n}\n\nconst TRANSITION_TIME = 300 // ms\n\nconst ChordList = ({chords, onSelect, inProp}) =\u003e {\n  const [height, setHeight] = useState(0)\n  return (\n    \u003cCSSTransition\n      in={inProp}\n      appear={true}\n      timeout={1000}\n      onEntering={() =\u003e setHeight(40 * chords.length)}\n      onExit={() =\u003e setHeight(0)}\n    \u003e\n      \u003cdiv className=\"chords\" style={{height: height}}\u003e\n        {/* chords *should* be unique */}\n        {chords.map((chord, i) =\u003e {\n          const [startOpacity, endOpacity] = [1, 0.3]\n          let opacity\n          if (chords.length === 2) {\n            // hack - don't want a gradient for picking the first chord\n            opacity = 1\n          } else {\n            opacity = startOpacity + (i / chords.length) * (endOpacity - startOpacity)\n          }\n\n          return (\n            \u003cp\n              className=\"chord\"\n              chord={chord}\n              onClick={onSelect}\n              style={{opacity: opacity}}\n              key={chord}\n            \u003e{chord}\u003c/p\u003e)\n        })}\n        \u003cstyle jsx\u003e{`\n          .chords {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            transition: height ${TRANSITION_TIME}ms;\n            overflow: hidden;\n          }\n\n          .chord {\n            cursor: pointer;\n            margin: 0.5em;\n          }\n        `}\u003c/style\u003e\n      \u003c/div\u003e\n    \u003c/CSSTransition\u003e\n  )\n}\n\nconst NextChordPicker = ({data, onSelect, inProp}) =\u003e {\n  let chords = []\n  for (const chord in data) {\n    chords.push([chord, data[chord]])\n  }\n  chords.sort((a, b) =\u003e b[1] - a[1])\n  chords = chords.map((x) =\u003e x[0])\n  return (\n    \u003cdiv className=\"next-chord-picker\"\u003e\n      \u003cChordList chords={chords} onSelect={onSelect} inProp={inProp} /\u003e\n    \u003c/div\u003e\n  )\n}\n\nconst FirstChordPicker = ({onSelect, inProp}) =\u003e (\n  \u003cdiv className=\"first-chord-picker\"\u003e\n    \u003cChordList chords={[\"1maj\", \"1min\", \"2min\", \"4maj\", \"5maj\"]} onSelect={onSelect} inProp={inProp} /\u003e\n  \u003c/div\u003e\n)\n\nconst ProgressionDisplay = ({chords, active, onSelect, listInProp}) =\u003e {\n  chords = [...chords]\n  const active_index = chords.length\n  const pad = 4 - chords.length\n  for (let i = 0; i \u003c pad; i++) { chords.push(\"?\") }\n\n  return (\n    \u003cdiv className=\"progression-display\"\u003e\n      {chords.map((chord, i) =\u003e {\n        return (\n          \u003cdiv key={i}\u003e\n            \u003cp className={\"progression-chord \" + (chord !== \"?\" ? \"selected\" : \"\")}\u003e{chord}\u003c/p\u003e\n            {active_index === 0 \u0026\u0026 i === 0 \u0026\u0026 active \u0026\u0026\n              \u003cFirstChordPicker onSelect={onSelect} inProp={listInProp} /\u003e}\n            {active_index === i \u0026\u0026 i \u003e 0 \u0026\u0026 active \u0026\u0026\n              \u003cNextChordPicker data={data[chords[i - 1]]} onSelect={onSelect} inProp={listInProp} /\u003e}\n          \u003c/div\u003e\n        )\n      })}\n      \u003cstyle jsx\u003e{`\n        .progression-display {\n          display: flex;\n          opacity: 1;\n        }\n\n        .progression-chord {\n          margin: 1em;\n          padding: 0.5em;\n          border: 1px solid black;\n          border-radius: 0.5em;\n          width: 3em;\n          text-align: center;\n          transition: opacity ${TRANSITION_TIME}ms;\n        }\n\n        .progression-chord:not(.selected) {\n          opacity: 0.3;\n        }\n      `}\u003c/style\u003e\n    \u003c/div\u003e\n  )\n}\n\nconst Text = ({clickable, text, onClick, inProp}) =\u003e {\n  return (\n    \u003cCSSTransition\n      in={inProp}\n      appear={true}\n      timeout={TRANSITION_TIME}\n    \u003e\n      \u003cdiv\n        className={\"text \" + (clickable ? \"clickable\" : \"\")}\n        onClick={onClick}\n      \u003e\n        \u003cp\u003e{text}\u003c/p\u003e\n        \u003cstyle jsx\u003e{`\n          .text {\n            font-weight: 400;\n            height: 2em;\n            margin: 0.5em;\n            transition: opacity ${TRANSITION_TIME}ms;\n          }\n\n          .clickable {\n            cursor: pointer;\n          }\n\n          .enter {\n            opacity: 0;\n          }\n\n          .enter-active, .enter-done {\n            opacity: 1;\n          }\n\n          .exit-active, .exit-done {\n            opacity: 0;\n          }\n\n          p {\n            font-size: 1.5em;\n            margin: 0;\n          }\n        `}\u003c/style\u003e\n      \u003c/div\u003e\n    \u003c/CSSTransition\u003e\n  )\n}\n\nclass ChordPicker extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      chords: [],\n      started: false,\n      textInProp: true,\n      listInProp: false\n    }\n  }\n\n  render() {\n    const resetChords = () =\u003e {\n      this.midiSounds.stopPlayLoop()\n      this.setState({chords: [], textInProp: true})\n    }\n\n    const chordToNotes = (chord) =\u003e {\n      let offsetLen\n      if (chord.startsWith(\"b\")) {\n        offsetLen = 2\n      } else {\n        offsetLen = 1\n      }\n      const offset = chord.substring(0, offsetLen)\n      const shape = chord.substring(offsetLen, chord.length)\n      return CHORDS[shape].map(x =\u003e x + OFFSETS[offset])\n    }\n\n    const playChords = () =\u003e {\n      if (this.state.chords.length == 0) return\n      const beat = this.state.chords.map((chord) =\u003e [\n        [], // drums\n        [\n          [3, chordToNotes(chord), 1]\n        ]\n      ])\n      this.midiSounds.startPlayLoop(beat, TEMPO, 1)\n    }\n\n    const selectChord = (e) =\u003e {\n      const chord = e.target.getAttribute(\"chord\")\n      this.setState({listInProp: false})\n      if (this.state.chords.length === 3) {\n        this.setState({textInProp: false})\n      }\n\n      setTimeout(\n        () =\u003e {\n          this.setState(\n            (oldState) =\u003e { return {chords: oldState.chords.concat([chord]), listInProp: true} },\n            () =\u003e {\n              if (this.midiSounds.loopStarted) {\n                this.midiSounds.stopPlayLoop()\n                playChords()\n              }\n            }\n          )\n        },\n        TRANSITION_TIME\n      )\n\n    }\n\n    const clear_enabled = this.state.chords.length \u003e 0\n    const play_enabled = this.state.chords.length === 4\n    const stop_enabled = this.state.chords.length === 4\n\n    let text\n    if (!this.state.started) {\n      text = \"Click to start!\"\n    } else if (this.state.chords.length === 0) {\n      text = \"Pick your first chord\"\n    } else if (this.state.chords.length \u003c 4) {\n      text = \"Pick your next chord\"\n    } else {\n      text = \"\"\n    }\n    let textOnClick\n    if (this.state.started) {\n      textOnClick = undefined\n    } else {\n      textOnClick = () =\u003e {\n        this.setState({textInProp: false})\n        setTimeout(\n          () =\u003e this.setState({started: true, textInProp: true, listInProp: true}),\n          TRANSITION_TIME\n        )\n      }\n    }\n\n    const iconSize = \"30px\"\n\n    return (\n      \u003cdiv id=\"chord-picker\"\u003e\n        \u003cMIDISounds\n          ref={(ref) =\u003e (this.midiSounds = ref)}\n          appElementName=\"__next\"\n          instruments={[3]}\n        /\u003e\n\n        \u003cText\n          text={text}\n          onClick={textOnClick}\n          clickable={!this.state.started}\n          inProp={this.state.textInProp}\n        /\u003e\n\n        \u003cdiv className=\"controls\"\u003e\n          \u003cspan\n            className={\"button \" + (clear_enabled ? \"enabled\" : \"disabled\")}\n            onClick={clear_enabled ? resetChords : undefined}\n           \u003e\u003cClear fontSize=\"inherit\" /\u003e\u003c/span\u003e\n          \u003cspan\n            className={\"button material-icons-outlined \" + (play_enabled ? \"enabled\" : \"disabled\")}\n            onClick={play_enabled ? playChords : undefined}\n          \u003e\u003cPlayArrow fontSize=\"inherit\" /\u003e\u003c/span\u003e\n          \u003cspan\n            className={\"button material-icons-outlined \" + (stop_enabled ? \"enabled\" : \"disabled\")}\n            onClick={stop_enabled ? () =\u003e this.midiSounds.stopPlayLoop() : undefined}\n          \u003e\u003cStop fontSize=\"inherit\" /\u003e\u003c/span\u003e\n        \u003c/div\u003e\n\n        \u003cProgressionDisplay\n          chords={this.state.chords}\n          active={this.state.started}\n          onSelect={selectChord}\n          listInProp={this.state.listInProp}\n        /\u003e\n      \u003cstyle jsx\u003e{`\n        #chord-picker {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          margin-top: 5em;\n          min-height: 750px;\n        }\n\n        .button {\n          font-size: 30px;\n          margin: 4px;\n          cursor: pointer;\n          transition: opacity ${TRANSITION_TIME}ms;\n        }\n\n        .button.enabled {\n          opacity: 1;\n        }\n\n        .button.disabled {\n          opacity: 0.3;\n        }\n\n        // doesn't work\n        .MIDISounds {\n          display: none;\n        }\n      `}\u003c/style\u003e\n      \u003c/div\u003e\n    )\n  }\n}\n\nexport default function ChordPickerFn() { return \u003cChordPicker /\u003e }\n","codeFilename":"chord_data.jsx","hasReactComponent":true,"pinned":false,"title":"Data-driven Chord Progressions","date":"2020-10-25","languages":["js","react"]}},"__N_SSG":true},"page":"/sketches/[id]","query":{"id":"chord_data"},"buildId":"zl-_aqTn1TSfHBk57P2zG","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-dccdf6a71d009d028b56.js"></script><script src="/_next/static/chunks/main-70acde2203962b3dc5d4.js" async=""></script><script src="/_next/static/chunks/webpack-50d38cb9c3dd5374e2a2.js" async=""></script><script src="/_next/static/chunks/framework.0a4392dc64510ab178c1.js" async=""></script><script src="/_next/static/chunks/commons.6d3bde474c27debf47e2.js" async=""></script><script src="/_next/static/chunks/pages/_app-1018bc17b6123053b3bf.js" async=""></script><script src="/_next/static/chunks/fe66c3e56503ac18952228a608ca3464c3766972.02ceb7646fd5a00b4908.js" async=""></script><script src="/_next/static/chunks/pages/sketches/%5Bid%5D-efff1a0c2435fd0b2b31.js" async=""></script><script src="/_next/static/zl-_aqTn1TSfHBk57P2zG/_buildManifest.js" async=""></script><script src="/_next/static/zl-_aqTn1TSfHBk57P2zG/_ssgManifest.js" async=""></script></body></html>